#include <array>
#include <string_view>
#include <cstdint>

enum class RVInstruction {
    LUI, // RV32I
    AUIPC,
    JAL,
    JALR,
    BEQ,
    BNE,
    BLT,
    BGE,
    BLTU,
    BGEU,
    LB,
    LH,
    LW,
    LBU,
    LHU,
    SB,
    SH,
    SW,
    ADDI,
    SLTI,
    SLTIU,
    XORI,
    ORI,
    ANDI,
    SLLI,
    SRLI,
    SRAI,
    ADD,
    SUB,
    SLL,
    SLT,
    SLTU,
    XOR,
    SRL,
    SRA,
    OR,
    AND,
    FENCE,
    FENCETSO,
    PAUSE,
    ECALL,
    EBREAK,
    LWU, // RV64I
    LD,
    SD,
    ADDIW,
    SLLIW,
    SRLIW,
    SRAIW,
    ADDW,
    SUBW,
    SLLW,
    SRLW,
    SRAW,
    FMADDS, // RV32F
    FMSUBS,
    FNMSUBS,
    FNMADDS,
    FADDS,
    FSUBS,
    FMULS,
    FDIVS,
    FSQRTS,
    FSGNJS,
    FSGNJNS,
    FSGNJXS,
    FMINS,
    FMAXS,
    FCVTWS,
    FCVTWUS,
    FMVXW,
    FEQS,
    FLTS,
    FLES,
    FCLASSS,
    FCVTSW,
    FCVTSWU,
    FMVWX,
    FLW,
    FSW,
    FCVTLS, // RV64F
    FCVTLUS,
    FCVTSL,
    FCVTSLU,
    FADDD, // RV32D
    FCLASSD,
    FCVTDH,
    FCVTDS,
    FCVTDW,
    FCVTDWU,
    FCVTHD,
    FCVTSD,
    FCVTWD,
    FCVTWUD,
    FCVTMODWD,
    FDIVD,
    FEQD,
    FLD,
    FLED,
    FLEQD,
    FMADDD,
    FMAXD,
    FMAXMD,
    FMIND,
    FMINMD,
    FMSUBD,
    FMULD,
    FMVHXD,
    FMVPDX,
    FNMADDD,
    FNMSUBD,
    FROUNDD,
    FSD,
    FSGNJD,
    FSGJND,
    FSGNJXD,
    FSQRTD,
    FSUBD,
    FCVTLD, // RV64D
    FCVTLUD,
    FMVXD,
    FCVTDL,
    FCVTDLU,
    FMVDX
};

enum class RVInstructionType {
    R,
    I,
    S,
    B,
    U,
    J,
};

enum class RVInstructionSet {
    RV32I,
    RV64I,
    RV32M,
    RV64M,
    RV32A,
    RV64A,
    RV32F,
    RV64F,
    RV32D,
    RV64D,
    RV32Q,
    RV64Q,
    RV32Zfh,
    RV64Zfh,
    Zifencei,
    Zicsr,
    Zawrs
};

struct rvinstruction {
    std::string_view name;
    RVInstructionType type;
    RVInstruction id;
    uint8_t opcode;
    uint16_t funct;
    RVInstructionSet set;
};

constexpr std::array<rvinstruction, 122> instructions = {
        {{"lui", RVInstructionType::U, RVInstruction::LUI, 0b0110111, 0b0, RVInstructionSet::RV32I},
         {"auipc", RVInstructionType::U, RVInstruction::AUIPC, 0b0010111, 0b0, RVInstructionSet::RV32I},
         {"jal", RVInstructionType::J, RVInstruction::JAL, 0b1101111, 0b0, RVInstructionSet::RV32I},
         {"jalr", RVInstructionType::I, RVInstruction::JALR, 0b1100111, 0b0, RVInstructionSet::RV32I},
         {"beq", RVInstructionType::B, RVInstruction::BEQ, 0b1100011, 0b0, RVInstructionSet::RV32I},
         {"bne", RVInstructionType::B, RVInstruction::BNE, 0b1100011, 0b1, RVInstructionSet::RV32I},
         {"blt", RVInstructionType::B, RVInstruction::BLT, 0b1100011, 0b100, RVInstructionSet::RV32I},
         {"bge", RVInstructionType::B, RVInstruction::BGE, 0b1100011, 0b101, RVInstructionSet::RV32I},
         {"bltu", RVInstructionType::B, RVInstruction::BLTU, 0b1100011, 0b110, RVInstructionSet::RV32I},
         {"bgeu", RVInstructionType::B, RVInstruction::BGEU, 0b1100011, 0b111, RVInstructionSet::RV32I},
         {"lb", RVInstructionType::I, RVInstruction::LB, 0b0000011, 0b0, RVInstructionSet::RV32I},
         {"lh", RVInstructionType::I, RVInstruction::LH, 0b0000011, 0b001, RVInstructionSet::RV32I},
         {"lw", RVInstructionType::I, RVInstruction::LW, 0b0000011, 0b010, RVInstructionSet::RV32I},
         {"lbu", RVInstructionType::I, RVInstruction::LBU, 0b0000011, 0b100, RVInstructionSet::RV32I},
         {"lhu", RVInstructionType::I, RVInstruction::LHU, 0b0000011, 0b101, RVInstructionSet::RV32I},
         {"sb", RVInstructionType::S, RVInstruction::SB, 0b0100011, 0b000, RVInstructionSet::RV32I},
         {"sh", RVInstructionType::S, RVInstruction::SH, 0b0100011, 0b001, RVInstructionSet::RV32I},
         {"sw", RVInstructionType::S, RVInstruction::SW, 0b0100011, 0b010, RVInstructionSet::RV32I},
         {"addi", RVInstructionType::I, RVInstruction::ADDI, 0b0010011, 0b000, RVInstructionSet::RV32I},
         {"slti", RVInstructionType::I, RVInstruction::SLTI, 0b0010011, 0b010, RVInstructionSet::RV32I},
         {"sltiu", RVInstructionType::I, RVInstruction::SLTIU, 0b0010011, 0b011, RVInstructionSet::RV32I},
         {"xori", RVInstructionType::I, RVInstruction::XORI, 0b0010011, 0b100, RVInstructionSet::RV32I},
         {"ori", RVInstructionType::I, RVInstruction::ORI, 0b0010011, 0b110, RVInstructionSet::RV32I},
         {"andi", RVInstructionType::I, RVInstruction::ANDI, 0b0010011, 0b111, RVInstructionSet::RV32I},
         {"slli", RVInstructionType::I, RVInstruction::SLLI, 0b0010011, 0b001, RVInstructionSet::RV32I},
         {"srli", RVInstructionType::I, RVInstruction::SRLI, 0b0010011, 0b101, RVInstructionSet::RV32I},
         {"srai", RVInstructionType::I, RVInstruction::SRAI, 0b0010011, 0b101, RVInstructionSet::RV32I},
         {"add", RVInstructionType::R, RVInstruction::ADD, 0b0110011, 0b000, RVInstructionSet::RV32I},
         {"sub", RVInstructionType::R, RVInstruction::SUB, 0b0110011, 0b000, RVInstructionSet::RV32I},
         {"sll", RVInstructionType::R, RVInstruction::SLL, 0b0110011, 0b001, RVInstructionSet::RV32I},
         {"slt", RVInstructionType::R, RVInstruction::SLT, 0b0110011, 0b010, RVInstructionSet::RV32I},
         {"sltu", RVInstructionType::R, RVInstruction::SLTU, 0b0110011, 0b011, RVInstructionSet::RV32I},
         {"xor", RVInstructionType::R, RVInstruction::XOR, 0b0110011, 0b100, RVInstructionSet::RV32I},
         {"srl", RVInstructionType::R, RVInstruction::SRL, 0b0110011, 0b101, RVInstructionSet::RV32I},
         {"sra", RVInstructionType::R, RVInstruction::SRA, 0b0110011, 0b101, RVInstructionSet::RV32I},
         {"or", RVInstructionType::R, RVInstruction::OR, 0b0110011, 0b110, RVInstructionSet::RV32I},
         {"and", RVInstructionType::R, RVInstruction::AND, 0b0110011, 0b111, RVInstructionSet::RV32I},
         {"fence", RVInstructionType::I, RVInstruction::FENCE, 0b0001111, 0b0000, RVInstructionSet::RV32I},
         {"fence.tso", RVInstructionType::I, RVInstruction::FENCETSO, 0b0001111, 0b1000, RVInstructionSet::RV32I},
         {"pause", RVInstructionType::I, RVInstruction::PAUSE, 0b0001111, 0b0010, RVInstructionSet::RV32I},
         {"ecall", RVInstructionType::I, RVInstruction::ECALL, 0b1110011, 0b000000000000, RVInstructionSet::RV32I},
         {"ebreak", RVInstructionType::I, RVInstruction::EBREAK, 0b1110011, 0b000000000001, RVInstructionSet::RV32I},
         {"lwu", RVInstructionType::I, RVInstruction::LWU, 0b0000011, 0b110, RVInstructionSet::RV64I},
         {"ld", RVInstructionType::I, RVInstruction::LD, 0b0000011, 0b011, RVInstructionSet::RV64I},
         {"sd", RVInstructionType::S, RVInstruction::SD, 0b0100011, 0b011, RVInstructionSet::RV64I},
         {"addiw", RVInstructionType::I, RVInstruction::ADDIW, 0b0011011, 0b000, RVInstructionSet::RV64I},
         {"slliw", RVInstructionType::I, RVInstruction::SLLIW, 0b0011011, 0b001, RVInstructionSet::RV64I},
         {"srliw", RVInstructionType::I, RVInstruction::SRLIW, 0b0011011, 0b101, RVInstructionSet::RV64I},
         {"sraiw", RVInstructionType::I, RVInstruction::SRAIW, 0b0011011, 0b101, RVInstructionSet::RV64I},
         {"addw", RVInstructionType::R, RVInstruction::ADDW, 0b0111011, 0b000, RVInstructionSet::RV64I},
         {"subw", RVInstructionType::R, RVInstruction::SUBW, 0b0111011, 0b000, RVInstructionSet::RV64I},
         {"sllw", RVInstructionType::R, RVInstruction::SLLW, 0b0111011, 0b001, RVInstructionSet::RV64I},
         {"srlw", RVInstructionType::R, RVInstruction::SRLW, 0b0111011, 0b101, RVInstructionSet::RV64I},
         {"sraw", RVInstructionType::R, RVInstruction::SRAW, 0b0111011, 0b101, RVInstructionSet::RV64I},
         {"fmadd.s", RVInstructionType::R, RVInstruction::FMADDS, 0b1000011, 0b00, RVInstructionSet::RV32F},
         {"fmsub.s", RVInstructionType::R, RVInstruction::FMSUBS, 0b1000011, 0b00, RVInstructionSet::RV32F},
         {"fnmsub.s", RVInstructionType::R, RVInstruction::FNMSUBS, 0b1000011, 0b00, RVInstructionSet::RV32F},
         {"fnmadd.s", RVInstructionType::R, RVInstruction::FNMADDS, 0b1000011, 0b00, RVInstructionSet::RV32F},
         {"fadd.s", RVInstructionType::R, RVInstruction::FADDS, 0b1010011, 0b0000000, RVInstructionSet::RV32F},
         {"fsub.s", RVInstructionType::R, RVInstruction::FSUBS, 0b1010011, 0b0000100, RVInstructionSet::RV32F},
         {"fmul.s", RVInstructionType::R, RVInstruction::FMULS, 0b1010011, 0b0001000, RVInstructionSet::RV32F},
         {"fdiv.s", RVInstructionType::R, RVInstruction::FDIVS, 0b1010011, 0b0001100, RVInstructionSet::RV32F},
         {"fsqrt.s", RVInstructionType::R, RVInstruction::FSQRTS, 0b1010011, 0b0101100, RVInstructionSet::RV32F},
         {"fsgnj.s", RVInstructionType::R, RVInstruction::FSGNJS, 0b1010011, 0b0010000, RVInstructionSet::RV32F},
         {"fsgnjn.s", RVInstructionType::R, RVInstruction::FSGNJNS, 0b1010011, 0b0010000, RVInstructionSet::RV32F},
         {"fsgnjx.s", RVInstructionType::R, RVInstruction::FSGNJXS, 0b1010011, 0b0010000, RVInstructionSet::RV32F},
         {"fmin.s", RVInstructionType::R, RVInstruction::FMINS, 0b1010011, 0b0000100, RVInstructionSet::RV32F},
         {"fmax.s", RVInstructionType::R, RVInstruction::FMAXS, 0b1010011, 0b0000100, RVInstructionSet::RV32F},
         {"fcvt.w.s", RVInstructionType::R, RVInstruction::FCVTWS, 0b1010011, 0b1100000, RVInstructionSet::RV32F},
         {"fcvt.wu.s", RVInstructionType::R, RVInstruction::FCVTWUS, 0b1010011, 0b1100000, RVInstructionSet::RV32F},
         {"fmv.x.w", RVInstructionType::R, RVInstruction::FMVXW, 0b1010011, 0b1110000, RVInstructionSet::RV32F},
         {"feq.s", RVInstructionType::R, RVInstruction::FEQS, 0b1010011, 0b1010000, RVInstructionSet::RV32F},
         {"flt.s", RVInstructionType::R, RVInstruction::FLTS, 0b1010011, 0b1010000, RVInstructionSet::RV32F},
         {"fle.s", RVInstructionType::R, RVInstruction::FLES, 0b1010011, 0b1010000, RVInstructionSet::RV32F},
         {"fclass.s", RVInstructionType::R, RVInstruction::FCLASSS, 0b1010011, 0b1110000, RVInstructionSet::RV32F},
         {"fcvt.s.w", RVInstructionType::R, RVInstruction::FCVTSW, 0b1010011, 0b1101000, RVInstructionSet::RV32F},
         {"fcvt.s.wu", RVInstructionType::R, RVInstruction::FCVTSWU, 0b1010011, 0b1101000, RVInstructionSet::RV32F},
         {"fmv.w.x", RVInstructionType::R, RVInstruction::FMVWX, 0b1010011, 0b1111000, RVInstructionSet::RV32F},
         {"flw", RVInstructionType::I, RVInstruction::FLW, 0b0000111, 0b010, RVInstructionSet::RV32F},
         {"fsw", RVInstructionType::S, RVInstruction::FSW, 0b0100111, 0b010, RVInstructionSet::RV32F},
         {"fcvt.l.s", RVInstructionType::R, RVInstruction::FCVTLS, 0b1010011, 0b1101000, RVInstructionSet::RV64F},
         {"fcvt.lu.s", RVInstructionType::R, RVInstruction::FCVTLUS, 0b1010011, 0b1101000, RVInstructionSet::RV64F},
         {"fcvt.s.l", RVInstructionType::R, RVInstruction::FCVTSL, 0b1010011, 0b1100000, RVInstructionSet::RV64F},
         {"fcvt.s.lu", RVInstructionType::R, RVInstruction::FCVTSLU, 0b1010011, 0b1100000, RVInstructionSet::RV64F},
         {"fadd.d", RVInstructionType::R, RVInstruction::FADDD, 0b1000011, 0b00, RVInstructionSet::RV32D},
         {"fmadd.d", RVInstructionType::R, RVInstruction::FMADDD, 0b1000011, 0b00, RVInstructionSet::RV32D},
         {"fclass.d", RVInstructionType::R, RVInstruction::FCLASSD, 0b1010011, 0b1110000, RVInstructionSet::RV32D},
         {"fcvt.d.h", RVInstructionType::R, RVInstruction::FCVTDH, 0b1010011, 0b1100000, RVInstructionSet::RV32D},
         {"fcvt.d.s", RVInstructionType::R, RVInstruction::FCVTDS, 0b1010011, 0b1101000, RVInstructionSet::RV32D},
         {"fcvt.d.w", RVInstructionType::R, RVInstruction::FCVTDW, 0b1010011, 0b1101000, RVInstructionSet::RV32D},
         {"fcvt.d.wu", RVInstructionType::R, RVInstruction::FCVTDWU, 0b1010011, 0b1101000, RVInstructionSet::RV32D},
         {"fcvt.h.d", RVInstructionType::R, RVInstruction::FCVTHD, 0b1010011, 0b1110000, RVInstructionSet::RV32D},
         {"fcvt.s.d", RVInstructionType::R, RVInstruction::FCVTSD, 0b1010011, 0b1100000, RVInstructionSet::RV32D},
         {"fcvt.w.d", RVInstructionType::R, RVInstruction::FCVTWD, 0b1010011, 0b1101000, RVInstructionSet::RV32D},
         {"fcvt.wu.d", RVInstructionType::R, RVInstruction::FCVTWUD, 0b1010011, 0b1101000, RVInstructionSet::RV32D},
         {"fcvt.mod.w.d", RVInstructionType::R, RVInstruction::FCVTMODWD, 0b1010011, 0b1101000, RVInstructionSet::RV32D},
         {"fdiv.d", RVInstructionType::R, RVInstruction::FDIVD, 0b1010011, 0b0001101, RVInstructionSet::RV32D},
         {"feq.d", RVInstructionType::R, RVInstruction::FEQD, 0b1010011, 0b1010001, RVInstructionSet::RV32D},
         {"fld", RVInstructionType::I, RVInstruction::FLD, 0b0000111, 0b011, RVInstructionSet::RV32D},
         {"fled", RVInstructionType::R, RVInstruction::FLED, 0b1010011, 0b1010001, RVInstructionSet::RV32D},
         {"fle.d", RVInstructionType::R, RVInstruction::FLEQD, 0b1010011, 0b1010001, RVInstructionSet::RV32D},
         {"fmin.d", RVInstructionType::R, RVInstruction::FMIND, 0b1010011, 0b0000101, RVInstructionSet::RV32D},
         {"fmin.d", RVInstructionType::R, RVInstruction::FMINMD, 0b1010011, 0b0000101, RVInstructionSet::RV32D},
         {"fmsub.d", RVInstructionType::R, RVInstruction::FMSUBD, 0b1000011, 0b00, RVInstructionSet::RV32D},
         {"fmul.d", RVInstructionType::R, RVInstruction::FMULD, 0b1010011, 0b0001001, RVInstructionSet::RV32D},
         {"fmv.h.x.d", RVInstructionType::R, RVInstruction::FMVHXD, 0b1010011, 0b1111001, RVInstructionSet::RV32D},
         {"fmv.p.d.x", RVInstructionType::R, RVInstruction::FMVPDX, 0b1010011, 0b1111001, RVInstructionSet::RV32D},
         {"fnmadd.d", RVInstructionType::R, RVInstruction::FNMADDD, 0b1000011, 0b00, RVInstructionSet::RV32D},
         {"fnmsub.d", RVInstructionType::R, RVInstruction::FNMSUBD, 0b1000011, 0b00, RVInstructionSet::RV32D},
         {"fround.d", RVInstructionType::R, RVInstruction::FROUNDD, 0b1010011, 0b0000001, RVInstructionSet::RV32D},
         {"fsd", RVInstructionType::S, RVInstruction::FSD, 0b0100111, 0b011, RVInstructionSet::RV32D},
         {"fsgnj.d", RVInstructionType::R, RVInstruction::FSGNJD, 0b1010011, 0b0010001, RVInstructionSet::RV32D},
         {"fsgnjn.d", RVInstructionType::R, RVInstruction::FSGJND, 0b1010011, 0b0010001, RVInstructionSet::RV32D},
         {"fsgnjx.d", RVInstructionType::R, RVInstruction::FSGNJXD, 0b1010011, 0b0010001, RVInstructionSet::RV32D},
         {"fsqrt.d", RVInstructionType::R, RVInstruction::FSQRTD, 0b1010011, 0b0101101, RVInstructionSet::RV32D},
         {"fsub.d", RVInstructionType::R, RVInstruction::FSUBD, 0b1010011, 0b0000101, RVInstructionSet::RV32D},
         {"fcvt.l.d", RVInstructionType::R, RVInstruction::FCVTLD, 0b1010011, 0b1101001, RVInstructionSet::RV64D},
         {"fcvt.lu.d", RVInstructionType::R, RVInstruction::FCVTLUD, 0b1010011, 0b1101001, RVInstructionSet::RV64D},
         {"fmv.x.d", RVInstructionType::R, RVInstruction::FMVDX, 0b1010011, 0b1111001, RVInstructionSet::RV64D},
         {"fcvt.d.l", RVInstructionType::R, RVInstruction::FCVTDL, 0b1010011, 0b1100001, RVInstructionSet::RV64D},
         {"fcvt.d.lu", RVInstructionType::R, RVInstruction::FCVTDLU, 0b1010011, 0b1100001, RVInstructionSet::RV64D},
         {"fmv.d.x", RVInstructionType::R, RVInstruction::FMVDX, 0b1010011, 0b1111001000, RVInstructionSet::RV64D}}};
